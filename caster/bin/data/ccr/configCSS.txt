#
# This is a heavily modified version of Dragonfly's _multiedit.py command-module
#  meant to enable python  syntax with CCR

from dragonfly import *
from caster.lib import control, settings
from caster.lib.dfplus.hint.nodes import css
from caster.lib.dfplus.hint.hintnode import NodeRule, NodeAction
from caster.lib.dfplus.state.actions import ContextSeeker, Continuer, RegisteredAction
from caster.lib.dfplus.state.short import L, S, R

settings.register_language(".css", "CSS")


css_rule = NodeRule(css.getCSSNode(), None, control.STAT)

cmd.map = {
        # Spoken-form    ->    ->    ->     Action object
	"<" + css_rule.master_node.text + ">":  NodeAction(css_rule)+ContextSeeker(None,
                                                  [L(
                                                      S(["cancel"], css_rule.reset_node, None), 
                                                      S(["CSS"]+[x[0] for x in css_rule.master_node.explode_children(0, True)], lambda: False, None)
                                                      )
                                                   ], rspec="CSS", consume=False),
	"EM":		Text("NUMBER em"), 
	"pixels":	Text("NUMBER px"), 
	"percent":	Text("NUMBER %"), 
		
		
}

cmd.extras   = [
	RuleRef(css_rule, css_rule.master_node.text), 
           ]
cmd.defaults = {

           }



